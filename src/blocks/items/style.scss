@import '../../css/core/block';

.smb-items {
	--smb-items--style--boundary-line--border-color: var(--_lighter-color-gray);
	--smb-items--style--border--border-color: var(--_lighter-color-gray);

	&--glue {
		> .#{ $_prefix }c-row {
			margin-bottom: var(--_margin1);

			> .#{ $_prefix }c-row__col {
				margin-bottom: var(--_margin1);
			}
		}
	}

	&--fill {
		> .#{ $_prefix }c-row {
			> .#{ $_prefix }c-row__col {
				display: flex;
				flex-direction: column;

				.smb-items__item,
				.smb-items__item__body {
					flex: 1 1 0%;
					display: flex;
					flex-direction: column;
				}

				.smb-items__item__content {
					margin-bottom: auto;
				}
			}
		}
	}

	a.smb-items__item {
		color: inherit;
		text-decoration: none;
		@include _transition(opacity);

		@include _hover() {
			opacity: .8;
		}
	}

	&__item {
		display: block;
		position: relative;

		&__figure {
			margin-bottom: var(--_margin-1);
			text-align: center;
		}

		&__title {
			margin: 0;
			@include _set-font-size-level(2);
			font-weight: bold;
		}

		&__lede {
			@include _set-font-size-level(-1);

			> a {
				color: inherit;
			}
		}

		&__content {
			margin-top: var(--_margin-2);
		}

		&__action {
			margin-top: var(--_margin-1);
			text-align: center;
		}

		&--block-link {
			@include _transition(filter);

			@include _hover() {
				filter: brightness(90%);
			}

			:not(.smb-items__item__action) a {
				position: relative;
				z-index: 1;
			}

			.smb-items__item__action {
				a {
					filter: none !important; // Patch to blink

					// Fallback
					&::after {
						content: '';
						position: absolute;
						top: 0;
						right: 0;
						bottom: 0;
						left: 0;
					}
				}
			}
		}

		a.smb-items__item--block-link {
			display: block;
			color: inherit;
		}

		&--free {
			.smb-items__item__body {
				> * {
					margin-top: 0;
					margin-bottom: 0;
				}

				// @include _content();
			}
		}
	}
}

.smb-items__banner {
	position: relative;
	overflow: hidden;
	color: var(--wp--preset--color--white);

	@include _hover() {
		.smb-items__banner__figure {
			filter: brightness(80%);
		}
	}

	// @deprecated start
	&[class*="has-text-align-"] {
		text-align: initial;

		.smb-items__banner__body {
			flex-direction: column;
			align-items: center;
			justify-content: center;
		}
	}
	&.has-text-align-left .smb-items__banner__body { align-items: flex-start; }
	&.has-text-align-center .smb-items__banner__body { align-items: center; }
	&.has-text-align-right .smb-items__banner__body { align-items: flex-end; }
	// @deprecated end

	&--left {
		.smb-items__banner__body-inner {
			text-align: left;
		}
	}

	&--center {
		.smb-items__banner__body-inner {
			text-align: center;
		}
	}

	&--right {
		.smb-items__banner__body-inner {
			text-align: right;
		}
	}

	&--blur {
		.smb-items__banner__figure > img {
			filter: blur(3px);
			height: calc(100% + 6px);
			width: calc(100% + 6px);
			max-height: none;
			max-width: none;
			margin: -3px;
			transform: translateZ(0);
		}
	}

	&--standard,
	&--contents,
	&--wide,
	&--vstandard,
	&--vwide {
		.smb-items__banner__figure {
			position: absolute;
			top: 0;
			right: 0;
			bottom: 0;
			left: 0;

			> img {
				object-fit: cover;
			}

			&__dummy {
				position: absolute;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;

				&::before {
					display: none;
				}
			}
		}
	}

	&--contents {
		.smb-items__banner__body {
			position: relative;
		}
	}

	&--standard,
	&--wide,
	&--vstandard,
	&--vwide {
		position: relative;

		&::before {
			content: '';
			display: block;
		}
	}

	&--standard {
		&::before {
			padding: 75% 0 0;
		}
	}

	&--wide {
		&::before {
			padding: 56.25% 0 0;
		}
	}

	&--vstandard {
		max-height: 100vh;

		&::before {
			padding: 133.33333% 0 0;
		}
	}

	&--vwide {
		max-height: 100vh;

		&::before {
			padding: 177.77777% 0 0;
		}
	}

	&__figure {
		@include _transition(filter);

		> img {
			position: relative;
			display: block;
			height: 100% !important;
			width: 100% !important;
			object-fit: cover;
			object-position: 50% 50%;
		}

		&__dummy {
			position: relative;
			background-color: var(--_color-gray);

			&::before {
				content: '';
				display: block;
				padding: 56.25% 0 0;
			}
		}

		&__mask {
			position: absolute;
			top: 0;
			right: 0;
			bottom: 0;
			left: 0;
			background-color: var(--wp--preset--color-black);
		}
	}

	&__body {
		position: absolute;
		top: 0;
		right: 0;
		bottom: 0;
		left: 0;
		padding: var(--_padding1);

		a {
			position: relative;
			z-index: 1;
		}
	}

	&__title {
		line-height: 1.4;
	}

	&__lede {
		margin-top: var(--_margin-2);
		@include _set-font-size-level(-2);
	}

	&__action {
		font-size: 0 !important;

		> a::after {
			content: '';
			position: absolute;
			top: 0;
			right: 0;
			bottom: 0;
			left: 0;
		}
	}
}

.is-style-boundary-line.smb-items {
	overflow: hidden; // Remove the border of the leftmost item.

	> .c-row {
		margin-left: -1px;

		&--margin {
			margin-bottom: calc(-1 * var(--_margin2));
			margin-right: calc(-1 * var(--_margin2) * .5);
			margin-left: calc(-1 * var(--_margin2) * .5);

			> .c-row__col {
				margin-bottom: var(--_margin2);
				padding-right: calc(var(--_margin2) * .5);
				padding-left: calc(var(--_margin2) * .5);
			}
		}

		> .c-row__col {
			border-left: 1px solid var(--smb-items--style--boundary-line--border-color);
		}
	}
}

.is-style-border.smb-items {
	border: 1px solid var(--smb-items--style--border--border-color);
	overflow: hidden; // Remove the border of the leftmost/bottommost item.

	> .c-row {
		&--margin {
			margin-right: -1px;
			margin-bottom: -1px;
			margin-left: 0;

			> .c-row__col {
				padding: var(--_padding1);
			}
		}

		> .c-row__col {
			margin-top: -1px;
			margin-bottom: 0;
			border-bottom: 1px solid var(--smb-items--style--border--border-color);
			border-right: 1px solid var(--smb-items--style--border--border-color);
		}
	}
}
